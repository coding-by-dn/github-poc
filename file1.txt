Generic code (modified by individual stories)

Modified from f6-story-1.